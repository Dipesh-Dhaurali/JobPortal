<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Edit Job - Job Portal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  </head>
  <body>

  {% include 'hr/navbar.html' %}

<div class="container my-5">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <div class="card shadow">
        <div class="card-header bg-primary text-white">
          <h3 class="mb-0"><i class="fas fa-edit"></i> Edit Job Post</h3>
        </div>
        <div class="card-body">
          <!-- Display only non-field errors from form -->
          {% if form.non_field_errors %}
            {% for error in form.non_field_errors %}
              <div class="alert alert-danger alert-dismissible fade show" role="alert">
                <strong>Error:</strong> {{ error }}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
              </div>
            {% endfor %}
          {% endif %}

          <form method="post" action="{% url 'edit_job' job.id %}">
            {% csrf_token %}
            
            <!-- Use form.title instead of job.title to properly bind form data -->
            <div class="mb-3">
              <label for="title" class="form-label">Job Title</label>
              <input type="text" class="form-control {% if form.title.errors %}is-invalid{% endif %}" id="title" name="title" value="{{ form.title.value }}" placeholder="e.g., Software Engineer" required>
              {% if form.title.errors %}
                <div class="invalid-feedback d-block">{{ form.title.errors.0 }}</div>
              {% endif %}
            </div>

            <div class="mb-3">
              <label for="CompanyName" class="form-label">Company Name</label>
              <input type="text" class="form-control {% if form.CompanyName.errors %}is-invalid{% endif %}" id="CompanyName" name="CompanyName" value="{{ form.CompanyName.value }}" placeholder="e.g., Tech Solutions Pvt. Ltd." required>
              {% if form.CompanyName.errors %}
                <div class="invalid-feedback d-block">{{ form.CompanyName.errors.0 }}</div>
              {% endif %}
            </div>

            <div class="mb-3">
              <label for="address" class="form-label">Location</label>
              <input type="text" class="form-control {% if form.address.errors %}is-invalid{% endif %}" id="address" name="address" value="{{ form.address.value }}" placeholder="e.g., Kathmandu, Nepal" required>
              {% if form.address.errors %}
                <div class="invalid-feedback d-block">{{ form.address.errors.0 }}</div>
              {% endif %}
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="salaryLow" class="form-label">Minimum Salary (Rs.)</label>
                <div class="input-group">
                  <span class="input-group-text">Rs.</span>
                  <input type="number" class="form-control {% if form.salaryLow.errors %}is-invalid{% endif %}" id="salaryLow" name="salaryLow" value="{{ form.salaryLow.value }}" placeholder="30000" required>
                </div>
                {% if form.salaryLow.errors %}
                  <div class="invalid-feedback d-block">{{ form.salaryLow.errors.0 }}</div>
                {% endif %}
              </div>
              <div class="col-md-6 mb-3">
                <label for="salaryHigh" class="form-label">Maximum Salary (Rs.)</label>
                <div class="input-group">
                  <span class="input-group-text">Rs.</span>
                  <input type="number" class="form-control {% if form.salaryHigh.errors %}is-invalid{% endif %}" id="salaryHigh" name="salaryHigh" value="{{ form.salaryHigh.value }}" placeholder="50000" required>
                </div>
                {% if form.salaryHigh.errors %}
                  <div class="invalid-feedback d-block">{{ form.salaryHigh.errors.0 }}</div>
                {% endif %}
              </div>
            </div>

            <div class="mb-3">
              <label for="lastDateToApply" class="form-label">Last Date to Apply</label>
              <input type="date" class="form-control {% if form.lastDateToApply.errors %}is-invalid{% endif %}" id="lastDateToApply" name="lastDateToApply" value="{{ form.lastDateToApply.value|date:'Y-m-d' }}" required>
              {% if form.lastDateToApply.errors %}
                <div class="invalid-feedback d-block">{{ form.lastDateToApply.errors.0 }}</div>
              {% endif %}
            </div>

            <div class="d-grid gap-2">
              <button type="submit" class="btn btn-primary btn-lg">
                <i class="fas fa-save"></i> Update Job
              </button>
              <a href="{% url 'hrdash' %}" class="btn btn-secondary">
                <i class="fas fa-times"></i> Cancel
              </a>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
  </body>
</html>
